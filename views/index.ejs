<%- include('partials/header') %>

    <div class="stats-grid">
        <div class="stat-card animate-fade">
            <div class="stat-icon" style="background: rgba(99, 102, 241, 0.1); color: var(--primary);">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-info">
                <span class="text-muted">Total Students</span>
                <h2>
                    <%= stats.total %>
                </h2>
            </div>
        </div>
        <div class="stat-card animate-fade" style="animation-delay: 0.1s">
            <div class="stat-icon" style="background: rgba(192, 132, 252, 0.1); color: #c084fc;">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <div class="stat-info">
                <span class="text-muted">Active Courses</span>
                <h2>
                    <%= stats.courses %>
                </h2>
            </div>
        </div>
        <div class="stat-card animate-fade" style="animation-delay: 0.2s">
            <div class="stat-icon" style="background: rgba(34, 197, 94, 0.1); color: var(--success);">
                <i class="fas fa-calendar-check"></i>
            </div>
            <div class="stat-info">
                <span class="text-muted">New Today</span>
                <h2>
                    <%= stats.recent %>
                </h2>
            </div>
        </div>
    </div>

    <div class="header-flex" style="margin-top: 2rem;">
        <div>
            <h1>Student Directory</h1>
            <p class="text-muted">Manage and track student enrollment</p>
        </div>
        <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
            <button id="exportCSV" class="btn btn-ghost" title="Export to CSV">
                <i class="fas fa-file-export"></i> Export
            </button>
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="studentSearch" placeholder="Search by name, email or course...">
            </div>
        </div>
    </div>

    <div class="student-grid" id="studentGrid">
        <% if (students.length> 0) { %>
            <% students.forEach(student=> { %>
                <div class="student-card"
                    data-search="<%= student.name.toLowerCase() %> <%= student.email.toLowerCase() %> <%= student.course.toLowerCase() %>">
                    <div class="student-info">
                        <div
                            style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                            <span class="badge">
                                <%= student.course %>
                            </span>
                            <div class="student-initials">
                                <%= student.name.charAt(0) %>
                            </div>
                        </div>
                        <h3>
                            <%= student.name %>
                        </h3>
                        <p><i class="far fa-envelope"></i>
                            <%= student.email %>
                        </p>
                        <p><i class="far fa-calendar-alt"></i> Joined <%= new
                                Date(student.createdAt).toLocaleDateString(undefined, { month: 'short' , day: 'numeric'
                                , year: 'numeric' }) %>
                        </p>
                    </div>
                    <div class="actions">
                        <a href="/edit/<%= student._id %>" class="btn btn-ghost">
                            <i class="fas fa-edit"></i> Edit
                        </a>
                        <form action="/delete/<%= student._id %>?_method=DELETE" method="POST" style="display:inline;">
                            <button type="submit" class="btn btn-danger">
                                <i class="fas fa-trash-alt"></i> Delete
                            </button>
                        </form>
                    </div>
                </div>
                <% }) %>
                    <% } else { %>
                        <div class="card empty-state">
                            <i class="fas fa-user-graduate"></i>
                            <h2>No students found</h2>
                            <p>Start by adding your first student!</p>
                            <br>
                            <a href="/add" class="btn btn-primary">Add Student</a>
                        </div>
                        <% } %>
    </div>

    <%- include('partials/footer') %>